<!doctype html>
<html>
  <head>
    <title>FakeNewsAcademy</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel= "stylesheet" type= "text/css" href="{{ url_for('static', filename='results.css')}}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/bang_symbol.ico')}}" />

    <!-- SEARCHBAR -->
    <link href="{{ url_for('static', filename='searchbar.css')}}" rel="stylesheet" />
    <link href="{{ url_for('static', filename='global.css')}}" rel="stylesheet" />
    <link href="{{ url_for('static', filename='navbar.css')}}" rel="stylesheet" />

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="{{ url_for('static', filename='dataTable.css')}}" rel="stylesheet" />


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

  </head>
  <body>
    <script>
      var results = {{ results|tojson }};
      console.log(results);
    </script>

    {% include 'navbar.html' %}


    <div class="container-fluid">

      <div class="row">
      </div>

      <div class="row indrow">
        <div class="col-xs-0 col-md-2"></div>
        <div class="col-xs-12 col-md-8" id='search-box'>
          {% include 'searchbar.html' %}
        </div>

        <div class="col-xs-0 col-md-2"></div>
      </div>

      <div class="row loadrow" id="loading">
        <div class="col-xs-0 col-md-5"></div>
        <div class="col-xs-12 col-md-2">
          <div class="d-flex justify-content-center"></div>
          ... loading ...
        </div>

        <div class="col-xs-0 col-md-2"></div>
      </div>

      <div class="row indrow">
        <div class="col-xs-0 col-md-1"></div>

        <div class="col-xs-12 col-md-10">
        <div class="row"><div class="col-xs-12 col-md-12">
        <table id="dtBasicExample" class="table table-striped table-bordered table-sm" cellspacing="0" style="width:100%">
                <thead>
                    <tr class="d-flex">
                      <th class="th-sm col-6">Paper</th>
                      <th class="th-sm col-1">Year</th>
                      <th class="th-sm col-1">Cits</th>
                      <th class="th-sm col-1">PageR</th>
                      <th class="th-sm col-1">Hubs</th>
                      <th class="th-sm col-1">Auth.</th>
                      <th class="th-sm col-1">Betw.</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
                <tfoot>
                    <tr class="d-flex">
                      <th class="col-6">Paper</th>
                      <th class="col-1">Year</th>
                      <th class="col-1">Cits</th>
                      <th class="col-1">PageR</th>
                      <th class="col-1">Hubs</th>
                      <th class="col-1">Auth.</th>
                      <th class="col-1">Betw.</th>
                    </tr>
                </tfoot>
            </table>
          </div></div> <!-- fine row -->
      </div><!--fine col -->

      <div class="col-xs-0 col-md-1"></div>
      </div>


      <div class="row indrow">
      </div>


    </div> <!-- end container -->





    <script>

        let rank = function(value, scale){
          var img = ['<img src="{{ url_for('static', filename='img/_0.png') }}" width="20px" height="20px" alt="0">',
                    '<img src="{{ url_for('static', filename='img/_1.png') }}" width="20px" height="20px" alt="1">',
                    '<img src="{{ url_for('static', filename='img/_2.png') }}" width="20px" height="20px" alt="2">',
                    '<img src="{{ url_for('static', filename='img/_3.png') }}" width="20px" height="20px" alt="3">',
                    '<img src="{{ url_for('static', filename='img/4.png') }}" width="20px" height="20px" alt="4">'];
          for (i = 0; i < 5; i++) {
            if (scale[i] >= value) {
              return(img[i]);
            }
          }
        }

        $(document).ready(function () {

          jQuery.each(results['item-list'], function() {
            var s = '<tr class="d-flex"> \n';

            var auth = this.author;
            if(auth.length > 60){
              auth = auth.substring(0, 57) + '...'
            }
            s = s.concat('<td class="col-6"><a class="title_p" href="/paper/' + this.paper_id + '">' + this.title + '</a><p class="auth_p">' + auth + '</p></td>\n');
            s = s.concat('<td class="col-1">' + this.year + '</td>\n');
            s = s.concat('<td class="col-1">' + this.cit + '</td>\n');
            s = s.concat('<td class="col-1"><p class="score">' + this.pagerank + '</p>' + rank(this.pagerank, results['scales']['pagerank'])+ '</td>\n');
            s = s.concat('<td class="col-1"><p class="score">' + this.hubs + '</p>' + rank(this.hubs, results['scales']['hubs'])+ '</td>\n');
            s = s.concat('<td class="col-1"><p class="score">' + this.authorities + '</p>' + rank(this.authorities, results['scales']['authorities'])+ '</td>\n');
            s = s.concat('<td class="col-1"><p class="score">' + this.betweenness + '</p>' + rank(this.betweenness, results['scales']['betweenness'])+ '</td>\n');
            s = s.concat('</tr> \n');

            $('tbody').append(s)
          });


          // jQuery.each(results, function(i, val) {
          //   $("#" + i).append(document.createTextNode(" - " + val));
          // });

            $('#dtBasicExample').DataTable({"order": []});
            $('.dataTables_length').addClass('bs-select');

            document.getElementById('loading').style.visibility = 'hidden';
        });

    </script>

  <script type="text/javascript" src="{{ url_for('static', filename = 'search.js')}}" defer></script>
</body>
</html>
